# Полноценное Веб-приложение

## Описание проекта

Данный проект представляет собой современное полноценное веб-приложение, разработанное с использованием передовых технологий. Приложение построено по принципу клиент-серверной архитектуры и состоит из двух основных частей:

### Фронтенд (Client)

- Разработан на React 19 с использованием TypeScript
- Использует современный стек технологий для создания отзывчивого и интерактивного пользовательского интерфейса
- Реализован с использованием компонентного подхода и современных практик разработки
- Использует Feature-Sliced Design для организации кода

### Бэкенд (Server)

- Построен на Node.js с использованием Express
- Использует Moongoose в качестве базы данных
- Реализует RESTful API для взаимодействия с клиентской частью
- Поддерживает JWT аутентификацию
- Включает валидацию данных и обработку ошибок

## Структура проекта

### Корневая директория

```
/
├── Client/           # Фронтенд-приложение (React + TypeScript)
├── Server/           # Бэкенд-приложение (Node.js + Express)
├── .gitignore        # Игнорируемые Git-файлы
└── README.md         # Документация проекта
```

### Клиентская часть (Client)

```
Client/
├── src/
│   ├── app/           # Основные настройки приложения
│   │   ├── store/     # Redux store и слайсы
│   │   ├── providers/ # React провайдеры
│   │   └── routes/    # Маршрутизация
│   ├── entities/      # Бизнес-сущности и модели данных
│   │   └── article/   # Сущность статьи
│   ├── features/      # Функциональные модули
│   │   ├── auth/      # Аутентификация
│   │   ├── theme/     # Темы оформления
│   │   └── modals/    # Модальные окна
│   ├── pages/         # Компоненты страниц
│   ├── shared/        # Общие компоненты и утилиты
│   │   └── api/       # API-клиент (Axios)
│   ├── widgets/       # Составные компоненты
│   └── schemas/       # Схемы валидации
├── public/            # Статические файлы
└── package.json       # Зависимости фронтенда
```

### Серверная часть (Server)

```
Server/
├── src/
│   ├── controllers/   # Контроллеры для обработки запросов
│   │   ├── auth.mjs   # Контроллер аутентификации
│   │   ├── articles.mjs # Контроллер статей
│   │   └── root.mjs   # Корневой контроллер
│   ├── models/        # Модели данных
│   │   ├── users.mjs  # Модель пользователя
│   │   └── articles.mjs # Модель статьи
│   ├── routes/        # Маршруты API
│   │   ├── auth.mjs   # Маршруты аутентификации
│   │   ├── articles.mjs # Маршруты статей
│   │   └── index.mjs  # Основной роутер
│   ├── middlewares/   # Промежуточные обработчики
│   │   ├── validators/ # Валидаторы запросов
│   │   ├── authentication.mjs # Проверка аутентификации
│   │   ├── errorHandler.mjs   # Обработка ошибок
│   │   └── logRequest.mjs     # Логирование запросов
│   ├── schemas/       # Схемы валидации
│   │   └── userSchema.mjs # Схема пользователя
│   ├── utils/         # Вспомогательные функции
│   │   ├── token.mjs  # Работа с JWT
│   │   └── logger.mjs # Логирование
│   ├── config/        # Конфигурационные файлы
│   │   ├── db.mjs     # Настройки базы данных
│   │   ├── cors.mjs   # Настройки CORS
│   │   └── token.config.mjs # Настройки JWT
│   ├── data/          # Данные (для демо)
│   └── app.mjs        # Основной файл приложения
└── package.json       # Зависимости бэкенда
```

## Серверная часть (бэкенд)

### Основные технологии

- **Node.js** - Среда выполнения JavaScript
- **Express** - Веб-фреймворк для Node.js
- **MongoDB** - NoSQL база данных
- **Mongoose** - ODM для работы с MongoDB
- **JWT** - Аутентификация на основе токенов
- **Bcrypt** - Хеширование паролей
- **Joi** - Валидация данных
- **Cookie-parser** - Работа с куками

### Архитектура сервера

#### Маршруты (Routes)

- **Модульная структура** - Каждый функциональный модуль имеет свой роутер
- **Основные маршруты**:
  - `/` - Корневой маршрут
  - `/auth` - Аутентификация (регистрация, вход, выход)
  - `/articles` - Работа со статьями

#### Контроллеры (Controllers)

- **Разделение ответственности** - Каждый контроллер отвечает за определенную функциональность
- **Основные контроллеры**:
  - `auth.mjs` - Обработка аутентификации
  - `articles.mjs` - Обработка статей
  - `root.mjs` - Обработка корневого маршрута

#### Модели (Models)

- **Mongoose схемы** - Определение структуры данных
- **Основные модели**:
  - `User` - Пользователь (email, пароль, имя)
  - `Article` - Статья (заголовок, содержание, изображение)

#### Связи между моделями

### Механизмы аутентификации и авторизации

#### JWT Аутентификация

- **Токены** - Использование JWT для аутентификации
- **Хранение токенов** - В HTTP-only куках для безопасности

#### Middleware аутентификации

- **Проверка токенов** - Middleware для проверки JWT токенов
- **Защита маршрутов** - Middleware для защиты маршрутов
- **Обработка ошибок** - Обработка ошибок аутентификации

### Обработка ошибок

#### Централизованная обработка ошибок

- **Error Handler Middleware** - Обработка всех ошибок
- **Структурированные ошибки** - Форматирование ошибок для клиента
- **Логирование ошибок** - Логирование ошибок для отладки

#### Типы ошибок

- **Валидация** - Ошибки валидации данных
- **Аутентификация** - Ошибки аутентификации
- **Авторизация** - Ошибки авторизации
- **Серверные ошибки** - Внутренние ошибки сервера

### Middleware система

#### Аутентификация и Авторизация

- **Authentication Middleware**
  - Проверка JWT токенов
  - Валидация сессий
  - Проверка прав доступа
  - Обработка истечения токенов
  - Обновление токенов

#### Валидация данных

- **Request Validators**
  - Валидация входящих данных
  - Проверка типов данных
  - Санитизация входных данных
  - Кастомные правила валидации
  - Обработка ошибок валидации

#### Обработка ошибок

- **Error Handler**
  - Централизованная обработка ошибок
  - Логирование ошибок
  - Форматирование ответов об ошибках
  - Обработка различных типов ошибок
  - Безопасная передача информации об ошибках

#### Логирование

- **Request Logger**
  - Логирование входящих запросов
  - Отслеживание времени выполнения
  - Логирование ошибок
  - Аудит действий пользователей
  - Мониторинг производительности

### Валидация данных

#### На бэкенде

- **Joi** для валидации входящих данных
- **Схемы валидации**:
  - `userSchema.mjs` - Схема пользователя
- **Middleware для валидации**:
  - `validateRegisterUser.mjs` - Валидация регистрации
  - `validateLoginUser.mjs` - Валидация входа
- **Обработка ошибок валидации**:
  - Структурированные ошибки
  - Детальные сообщения об ошибках
  - Форматирование для клиента

## Клиентская часть (фронтенд)

### Основные технологии

- **React 19** - Библиотека для создания пользовательских интерфейсов
- **TypeScript** - Типизированный JavaScript
- **Redux Toolkit** - Управление состоянием
- **React Router** - Маршрутизация
- **Axios** - HTTP-клиент
- **Formik & Yup** - Валидация форм
- **Material-UI** - Компоненты интерфейса
- **SASS** - Стилизация

### Глобальное состояние (Redux)

#### Структура Redux

- **Store** - Центральное хранилище состояния
- **Slices** - Модули состояния:
  - `authSlice` - Состояние аутентификации
  - `articlesSlice` - Состояние статей
  - `themeSlice` - Состояние темы
  - `modalSlice` - Состояние модальных окон
  - `snackbarSlice` - Состояние уведомлений

#### Аутентификация в Redux

- **Состояние**:
  - `isAuthenticated` - Статус аутентификации
  - `user` - Данные пользователя
  - `loading` - Статус загрузки
  - `error` - Ошибки
- **Действия**:
  - `loginUser` - Вход пользователя
  - `logoutUser` - Выход пользователя
  - `checkAuthStatus` - Проверка статуса аутентификации

### Хранение токенов

- **HTTP-only куки** - Токены хранятся в HTTP-only куках
- **Безопасность** - Защита от XSS атак
- **Автоматическая отправка** - Axios настроен на отправку кук
- **Обновление токенов** - Автоматическое обновление токенов

### Маршрутизация

#### Публичные маршруты

- `/` - Главная страница
- `/login` - Страница входа
- `/register` - Страница регистрации

#### Защищенные маршруты

- `/articles` - Список статей
- `/articles/:id` - Детальная страница статьи

#### Защита маршрутов

- **Проверка аутентификации** - Редирект на страницу входа
- **Загрузка данных** - Загрузка данных пользователя
- **Обработка ошибок** - Обработка ошибок аутентификации

### Валидация форм

#### На фронтенде

- **Formik** для управления формами
- **Yup** для валидации:
  - `auth.ts` - Схемы валидации аутентификации
- **Обработка ошибок**:
  - Отображение ошибок валидации
  - Форматирование сообщений об ошибках
  - Предотвращение отправки невалидных данных

## API Endpoints

### Аутентификация

```
POST /api/auth/register - Регистрация нового пользователя
POST /api/auth/login    - Вход в систему
GET  /api/auth/me       - Получение данных текущего пользователя
POST /api/auth/logout   - Выход из системы
```

### Статьи

```
GET    /api/articles        - Получение списка статей
POST   /api/articles        - Создание новой статьи
GET    /api/articles/:id    - Получение статьи по ID
```

## Установка и запуск

### Предварительные требования

- Node.js (версия 18 или выше)
- MongoDB (версия 5 или выше)
- npm или yarn
- Docker и Docker Compose (опционально, для запуска в контейнерах)

### Установка и запуск с Docker

1. Клонирование репозитория

```bash
git clone [url-репозитория]
```

2. Запуск с помощью Docker Compose

```bash
docker-compose up --build
```

Это запустит все необходимые сервисы:

- Клиентское приложение на порту 3000
- Серверное приложение на порту 5000
- MongoDB на порту 27017

Для остановки:

```bash
docker-compose down
```

### Установка и запуск без Docker

1. Клонирование репозитория

```bash
git clone [url-репозитория]
```

2. Установка зависимостей фронтенда

```bash
cd Client
npm install
```

3. Установка зависимостей бэкенда

```bash
cd Server
npm install
```

4. Настройка окружения
   Создайте файл `.env` в директории Server:

```
PORT=3000
MONGODB_URI=mongodb://localhost:27017/your_database
JWT_SECRET=your_secret_key
NODE_ENV=development
```

### Запуск приложения

1. Запуск MongoDB (если не используете Docker)

```bash
mongod
```

2. Запуск сервера

```bash
cd Server
npm run dev
```

3. Запуск клиента

```bash
cd Client
npm run dev
```

## Доступные команды

### Фронтенд

- `npm run dev` - Запуск сервера разработки
- `npm run build` - Сборка для продакшена
- `npm run lint` - Проверка кода
- `npm run preview` - Предпросмотр продакшен сборки
- `npm run test` - Запуск тестов

### Бэкенд

- `npm run dev` - Запуск сервера разработки с nodemon
- `npm start` - Запуск продакшен сервера
- `npm run lint` - Проверка кода
- `npm run test` - Запуск тестов

### Безопасное хранение данных

- **Пароли**

  - Хеширование с использованием bcrypt
  - Соль для каждого пароля
  - Минимальные требования к сложности
  - Защита от перебора

- **Чувствительные данные**
  - Шифрование данных
  - Безопасное хранение ключей

## Масштабируемость

- Модульная архитектура
- Чистый код
- Переиспользуемые компоненты
- Оптимизированная производительность
- Готовность к масштабированию
- Кэширование
- Оптимизация запросов к БД
- Микросервисная архитектура (готовность)

## Архитектура проекта

### Docker конфигурация

Проект настроен для работы в Docker-контейнерах с использованием Docker Compose. Конфигурация включает:

#### Сервисы

- **client** - React-приложение
  - Порт: 3000
  - Hot-reload включен
  - Volume для разработки
- **server** - Node.js сервер
  - Порт: 5000
  - Подключение к MongoDB
  - Volume для разработки
- **mongo** - База данных MongoDB
  - Порт: 27017
  - Persistent volume для данных

#### Особенности Docker-конфигурации

- Hot-reload для разработки
- Persistent storage для MongoDB
- Изолированные сети между сервисами
- Оптимизированные multi-stage сборки
- Готовность к production-деплою
